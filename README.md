# Finder增强工具 v3.0

一个基于Electron开发的Mac Finder功能增强应用程序，提供智能空格预览和快捷剪切功能。

## 🚀 v3.0 重大更新

### 🎨 全新UI设计
- **毛玻璃效果界面**：采用macOS原生毛玻璃设计语言
- **简洁现代风格**：去除冗余元素，专注核心功能
- **完美动画体验**：流畅的窗口打开/关闭动画，模拟原生Quick Look
- **macOS风格窗口控制**：原生三色窗口控制按钮（红黄绿）

### ⚙️ 智能设置系统
- **可视化设置界面**：直观的设置选项管理
- **实时配置更新**：设置修改立即生效，无需重启
- **个性化定制**：文件数量限制、隐藏文件显示等选项
- **智能默认值**：开箱即用的最佳配置

### 🔧 系统优化升级
- **更稳定的快捷键系统**：智能条件拦截，完美解决系统冲突
- **增强的窗口管理**：无边框透明窗口，完全隐藏系统控制按钮
- **自定义托盘图标**：支持PNG格式的自定义图标
- **内存优化**：更低的资源占用和更快的响应速度

### 🐛 问题修复
- 修复设置保存时的方法调用错误
- 解决预览窗口意外显示窗口控制按钮的问题
- 优化动画性能，减少GPU占用
- 完善错误处理和用户反馈机制

## 功能特性

### 🔍 智能空格预览
- **智能识别**：自动识别文件夹和压缩包，仅在需要时拦截空格键
- **原生兼容**：PDF文件、文档等保持系统原生Quick Look体验
- **快速预览**：文件夹内容浏览，无需打开文件夹
- **压缩包支持**：ZIP、TAR等格式预览，无需解压
- **毛玻璃界面**：美观的半透明预览窗口
- **流畅动画**：从文件图标位置动画展开的预览窗口
- **详细信息**：文件大小、修改时间等完整显示

### ✂️ 智能剪切系统
- **条件拦截**：只在Finder中且有选中文件时拦截Cmd+X
- **系统兼容**：其他应用中的剪切功能完全不受影响
- **批量操作**：支持多文件同时剪切
- **可视化反馈**：剪切状态实时提示
- **完美集成**：与系统剪贴板无缝配合

### 🎛️ 现代化设置界面
- **毛玻璃设计**：与预览窗口统一的视觉风格
- **macOS风格控制**：原生三色窗口按钮
- **分类管理**：功能选项按类别清晰组织
- **实时预览**：设置修改立即生效
- **智能保存**：自动保存用户配置

### 🔧 系统集成优化
- 系统托盘运行，支持自定义图标
- 后台常驻，资源占用极低
- 完善的权限管理
- 支持开机自启动

## 版本历史

### v3.0.0 (当前版本) - UI革新与体验升级
- 🎨 **全新毛玻璃UI设计**：现代化界面，完美融入macOS
- ⚙️ **智能设置系统**：可视化设置界面，实时配置更新
- 🔧 **系统优化升级**：更稳定的快捷键系统，增强的窗口管理
- 🖼️ **自定义托盘图标**：支持PNG格式的个性化图标
- 🐛 **重要问题修复**：设置保存错误、窗口控制按钮等问题
- ✨ **动画性能优化**：更流畅的窗口动画效果

### v2.0.0 - 性能革命
- 🚀 **重大性能优化**：10-20倍响应速度提升
- 🎯 **智能拦截系统**：按需空格键管理，完美兼容PDF和文档
- ⚡ **缓存状态监控**：高效的150ms间隔状态检查
- 🔧 **系统优化**：防抖机制、循环防护、真正后台运行

### v1.0.0 - 基础功能
- 📁 基础文件夹预览功能
- ✂️ Cmd+X剪切功能
- 🎛️ 基本系统集成

> **升级建议**：v3.0版本带来了全新的用户体验，强烈推荐升级！

## 系统要求

- macOS 10.14 或更高版本
- 64位处理器
- 150MB 可用磁盘空间

## 下载安装

### 📦 直接下载（推荐）

从 [GitHub Releases](https://github.com/Kaedeeeeeeeeee/FinderEnhance/releases/latest) 下载最新版本：

- **Apple Silicon Mac (M1/M2/M3)**：[FinderEnhance-3.0.0-arm64.dmg](https://github.com/Kaedeeeeeeeeee/FinderEnhance/releases/download/v3.0.0/FinderEnhance-3.0.0-arm64.dmg) (96MB)
- **Intel Mac**：[FinderEnhance-3.0.0.dmg](https://github.com/Kaedeeeeeeeeee/FinderEnhance/releases/download/v3.0.0/FinderEnhance-3.0.0.dmg) (101MB)

### 🚀 快速安装步骤

1. **下载DMG文件**：选择适合您处理器的版本
2. **打开DMG文件**：双击下载的DMG文件
3. **拖拽安装**：将 `FinderEnhance.app` 拖拽到 `Applications` 文件夹
4. **首次运行**：右键点击应用选择"打开"（绕过未签名警告）
5. **授权权限**：在系统偏好设置中授予必要的辅助功能权限

> 💡 **详细安装指南**：查看 [INSTALLATION.md](INSTALLATION.md) 获取完整的安装和故障排除说明

### 🔧 从源码构建

1. **克隆项目**
   ```bash
   git clone https://github.com/Kaedeeeeeeeeee/FinderEnhance.git
   cd FinderEnhance
   ```

2. **安装依赖**
   ```bash
   npm install
   ```

3. **运行应用**
   ```bash
   npm start
   ```

4. **构建发布版本**
   ```bash
   # 使用自动化脚本
   ./scripts/build-release.sh
   
   # 或手动构建
   npm run build-mac
   ```

## 使用指南

### 首次启动

1. 启动应用后，图标将出现在系统托盘中
2. 右键点击托盘图标，选择"设置"配置功能选项
3. 确保"空格预览"和"Cmd+X剪切"功能已启用

### 空格预览使用

1. 在Finder中选中任意文件夹或压缩包
2. 按下**空格键**
3. 预览窗口将从文件图标位置动画展开
4. 再次按下**空格键**关闭预览窗口
5. 支持的快捷键：
   - `Space` - 打开/关闭预览
   - `Esc` - 关闭预览窗口

### 剪切功能使用

1. 在Finder中选中要剪切的文件或文件夹
2. 按下 `Cmd+X`（只在Finder中生效）
3. 导航到目标位置
4. 按下 `Cmd+V` 粘贴

### 设置界面使用

1. 右键点击托盘图标，选择"设置"
2. 在毛玻璃设置界面中调整各项功能
3. 点击"保存设置"应用修改
4. 使用左上角红色按钮关闭设置窗口

## 设置选项

### 空格预览功能
- **启用空格预览**: 开启/关闭空格预览功能
- **预览文件数量限制**: 设置预览窗口显示的最大文件数量（50-500个）
- **显示隐藏文件**: 在预览中显示以点开头的隐藏文件

### 剪切功能
- **启用Cmd+X剪切**: 开启/关闭智能剪切功能
- **显示剪切反馈**: 剪切时显示通知提示

### 高级设置
- **开机自启动**: 系统启动时自动运行应用
- **自动检查更新**: 定期检查应用更新

## 自定义图标

应用支持自定义托盘图标：

1. 准备一个16x16像素的PNG图标文件
2. 将图标文件命名为 `icon4.png`
3. 放置在 `assets/` 目录下
4. 重启应用即可看到新图标

## 故障排除

### 常见问题

**Q: 空格键不起作用？**
A: 请确保：
- 应用正在运行（托盘图标可见）
- 在设置中启用了"空格预览"功能
- 当前聚焦在Finder窗口中
- 已选中文件夹或支持的压缩包

**Q: Cmd+X剪切无效？**
A: 请检查：
- 设置中是否启用了"Cmd+X剪切"功能
- 是否在Finder中操作（智能条件拦截）
- 文件是否有写入权限

**Q: 设置界面显示异常？**
A: 尝试以下解决方法：
- 重新打开设置界面
- 检查系统显示设置
- 重启应用

**Q: 预览窗口动画卡顿？**
A: 可能的解决方案：
- 关闭其他占用GPU的应用
- 检查系统性能监控
- 重启应用

### 权限设置

某些功能可能需要系统权限：

1. **辅助功能权限**：
   - 打开"系统偏好设置" > "安全性与隐私" > "隐私"
   - 选择"辅助功能"
   - 添加FinderEnhance应用

2. **自动化权限**：
   - 在"隐私"设置中选择"自动化"
   - 允许FinderEnhance控制Finder

## 技术架构

### 主要技术栈
- **Electron**: 跨平台桌面应用框架
- **Node.js**: 后端逻辑处理
- **AppleScript**: 系统集成和Finder交互
- **HTML/CSS/JavaScript**: 用户界面
- **CSS Backdrop Filter**: 毛玻璃效果实现

### 项目结构
```
FinderEnhance/
├── package.json          # 项目配置
├── src/
│   ├── main.js           # 主进程入口
│   └── windows/          # 渲染进程窗口
│       ├── preview.html  # 预览窗口
│       ├── preview.css   # 预览样式
│       ├── preview.js    # 预览逻辑
│       ├── preferences.html # 设置窗口
│       ├── preferences.css  # 设置样式
│       └── preferences.js   # 设置逻辑
├── assets/               # 资源文件
│   └── icon4.png        # 托盘图标
└── README.md            # 项目说明
```

### 核心特性实现

#### 毛玻璃效果
使用CSS `backdrop-filter` 和 `background: rgba()` 实现：
```css
background: rgba(255, 255, 255, 0.85);
backdrop-filter: blur(25px) saturate(1.8) brightness(1.1);
```

#### 智能条件拦截
只在特定条件下拦截快捷键：
```javascript
// 只在Finder中且有选中文件时拦截Cmd+X
if (this.cachedFinderActive && this.cachedSelectedFile) {
  // 拦截并处理
} else {
  // 转发给系统
}
```

#### 流畅窗口动画
从文件图标位置到屏幕中央的缓动动画：
```javascript
const easeOutCubic = (t) => 1 - Math.pow(1 - t, 3);
// 应用到窗口位置和尺寸变化
```

## 开发指南

### 开发环境设置

1. **安装Node.js** (推荐v16+)
2. **克隆项目并安装依赖**
   ```bash
   git clone https://github.com/your-username/FinderEnhance.git
   cd FinderEnhance
   npm install
   ```

3. **开发模式运行**
   ```bash
   npm run dev
   ```

### 构建和打包

```bash
# 构建macOS应用
npm run build-mac

# 构建所有平台（如果配置了）
npm run build-all
```

### 代码结构说明

- `src/main.js`: 主进程，负责窗口管理、系统集成、快捷键处理
- `src/windows/preview.*`: 预览窗口相关代码
- `src/windows/preferences.*`: 设置窗口相关代码
- `assets/`: 静态资源文件

## 贡献指南

欢迎提交Issue和Pull Request！

### 提交Issue
- 详细描述问题现象
- 提供系统版本信息
- 附上错误日志（如有）

### 提交代码
1. Fork项目
2. 创建功能分支
3. 提交代码并写好commit信息
4. 发起Pull Request

## 许可证

MIT License - 详见 [LICENSE](LICENSE) 文件

## 联系方式

- GitHub Issues: [项目Issues页面](https://github.com/your-username/FinderEnhance/issues)
- 邮箱: your-email@example.com

---

**享受更智能的Mac文件管理体验！** 🚀 